{% extends '::base.html.twig' %}

{% block stylesheets %}
    
    {% stylesheets
        '@MondelSiteBundle/Resources/public/css/normalize.css'
        '@MondelSiteBundle/Resources/public/css/classes.css'
        '@MondelSiteBundle/Resources/public/css/form.css'
        '@MondelSiteBundle/Resources/public/css/layout.css'        
        filter='yui_css'
        output='css/compiled/main.css'
    %}
        <link rel="stylesheet" type="text/css" media="screen" href="{{ asset_url }}" />
    {% endstylesheets %}
    
    <!--[if lt IE 9]>
    <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

{% endblock %}

{% block body %}

    {% set error = app.session.getFlash('error') %}
    {% set notice = app.session.getFlash('notice') %}

    {% if error != '' %}

        <section id="error">Error: {{ error }}</section>

    {% endif %}

    {% if notice != '' %}

        <section id="notice">Notice: {{ notice }}</section>

    {% endif %}

    <header id="main-header" class="main-content">
        <div id="main-search-container" class="float-left">
            <input type="search" id="main-search" class="input-field">
        </div>
        <div id="user-info" class="float-right">

            {% if is_granted('ROLE_USER') %}

                <span>Hola @{{ app.security.token.user.nick }}</span>
            
            {% else %}
                
                <form id="login-form" action="{{ path('user_login_check') }}" method="post">
                    
                    {% set targetPath = app.request.getRequestUri | replace({'app_dev.php/': '', 'app.php/': ''}) %}
                    <input type="hidden" name="_target_path" value="{{ targetPath }}" />
                    
                    <input type="text" name="_username" id="username" class="input-field">
                    <input type="password" name="_password" id="password" class="input-field">
                    
                    <button id="login-button" class="button">Entrar</button>
                    
                    <input type="checkbox" id="remember_me" name="_remember_me" checked>
                    <span>No cerrar sesión</span>

                    <a href="{{ path('user_password_recover') }}">He perdido mi contraseña</a>                    
                </form>
            
            {% endif %}

        </div>
    </header>

    <section id="left-content">

        <img src="{{ asset('bundles/mondelsite/img/logo_cuentalo.png') }}" alt="Cuentalo">

    </section>

    <section id="main-content" class="main-content">        
                        
        <section id="content">      
            <aside id="left">       
                <div id="menu_usuarios">Menú de usuario</div>
                <div id="menu_izquierdo">
                    {% if is_granted('ROLE_USER') %}
                        <form method="get" action="{{ path('user_change_password') }}">
                            <button class="gray">
                                <span class="icon IconPass"></span>
                                <span class="label">Cambiar contraseña</span>           
                            </button>
                        </form>
                        <form method="get" action="{{ path('user_delete') }}">
                            <button class="gray">
                                <span class="icon IconDelete"></span>
                                <span class="label">Dar de baja mi cuenta</span>            
                            </button>
                        </form>
                    {% endif %}
                    <form method="get" action="{{ path('static_page', {'page': 'contact'}) }}">
                        <button class="gray">
                            <span class="icon IconContact"></span>
                            <span class="label">Contactarnos</span>
                        </button>
                    </form>
                    <form method="get" action="{{ path('static_page', {'page':'terms'}) }}">
                        <button class="gray">
                            <span class="icon IconTerm"></span>
                            <span class="label">T&eacute;rminos</span>
                        </button>
                    </form> 
                    <form method="get" action="{{ path('static_page', {'page':'what_is_cuentalo'}) }}">
                        <button class="gray">
                            <span class="icon IconQuees"></span>
                            <span class="label">Que es cuentalo?</span>
                        </button>
                    </form>
                    {% if is_granted('ROLE_USER') %}
                        {% set cssClassNotificacion = 
                            app.security.token.user.haveUnreadNotifications() ? 'red' : 'grey' %}
                        <form method="get" action="{{ path('home_page') }}">
                            <button class="button {{ cssClassNotificacion }}">
                                <span class="icon IconTerm"></span>
                                <span class="label">Notificaciones</span>
                            </button>
                        </form>
                    {% endif %}
                </div>      
                <div id="facebook">Seguinos en Facebook</div>
                <div class="fb-like-box" data-href="https://www.facebook.com/pages/Cuentalo/221560061231773" data-width="182" data-height="380" data-show-faces="true" data-stream="false" data-header="false"></div>           
            </aside>
            <section id="center">
                {% block content %}
                    <div class="Wrap">
                        <div id="message">
                            {% if app.session.hasFlash('notice') %}
                                <div class="Notice">
                                    {{ app.session.flash('notice') }}
                                </div>
                            {% elseif app.session.hasFlash('error') %}
                                <div class="Error">
                                    {{ app.session.flash('error') }}
                                </div>
                            {% endif %}
                        </div>
                    </div>
                {% endblock %}
            </section>
            <aside id="right">
                <div id="noticias">
                    <div id="titulo_noticias">Noticias</div>
                    <div class="Noticias">
                        
                    </div>
                </div>
                <div id="deportes">
                    <div id="titulo_deportes">Deportes</div>
                    <div class="Deportes"></div>
                </div>
                <a href="{{ path('static_page', {'page': 'contact'}) }}">
                    <div class="Cuentalopublicite"></div>
                </a>            
            </aside>
        </section>

    </section>

    
    <footer id="footer">
    </footer>
{% endblock %}
{% block javascripts %}
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.6.4/jquery.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.16/jquery-ui.min.js"></script>
    <script>
        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-27947390-1']);
        _gaq.push(['_trackPageview']);

        (function() {
            var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
        })();
    </script>
    <div id="fb-root"></div><!-- NO QUITAR ES PARA EL FACEBOOK SDK JAVASCRIPT -->    
    {#% javascripts '@MondelSiteBundle/Resources/public/js/functions.js'
                   '@MondelSiteBundle/Resources/public/js/layout.js'
                   filter='closure'
    %}
    <script src="{{ asset_url }}"></script>
    {% endjavascripts %#}
{% endblock %}


